## contracts.contract_mapping 
Mapping of contracts to its creators and names on EVM chains. # Contract Mapping

Table models are defined in [&#x60;macros/models/_sector/contracts&#x60;](/macros/models/_sector/contracts)

This repository contains all the source code for &#x60;contracts.contract_mapping&#x60; that you can use to join contract addresses on each chain to pull our mapped project names in the &#x60;contract_project&#x60; field.

Mappings are derived from either mapping the contract deployer address to a project name &#x60;contracts.contract_creator_address_list&#x60;, reading from Dune&#x27;s decoded contracts or manually overriding when the creator is not deterministic (i.e. the deployer creates contracts for multiple projects). We also use &#x60;contracts.project_name_mappings&#x60; to consolidate variations in project names. You can find the dependency graph generated by dbt [here](https://spellbook-docs.dune.com/#!/model/model.spellbook.contracts_contract_mapping).

## How to Use

Below is a simplified example of using contract mapping table to get apps creating most transactions in the last 24 hours.

&#x60;&#x60;&#x60;sql
select
  cm.contract_project
  ,count(*) as num_txs
  ,sum(t.l1_fee + t.gas_used * t.gas_price)/1e18 as eth_fees
from optimism.transactions as t
join contracts.contract_mapping as cm
  on t.to &#x3D; cm.contract_address
  AND cm.blockchain &#x3D; &#x27;optimism&#x27;
  and not is_self_destruct
where
  t.block_time &gt; now() - interval &#x27;24&#x27; hour
  and t.success
group by 1
order by 2 desc
&#x60;&#x60;&#x60;

## How To Contribute

1. Follow the format and add the creator address and contract project to &#x60;contracts_contract_creator_address_list.sql&#x60;
2. If you want to enforce consistent project name mapping other than Dune&#x27;s decoded contract one, then add the name mapping to &#x60;contracts_project_name_mappings.sql&#x60;
3. Submit the pull request (PR) and feel free to tag [@MSilb7](https://github.com/MSilb7) or [@chuxinh](https://github.com/chuxinh) if there&#x27;s any questions
4. Once the PR is merged, check on Dune if your work is correctly reflected ðŸ”´âœ¨

<ParamField path="blockchain">
Name of chain in Dune database
</ParamField>
<ParamField path="trace_creator_address">
Address creating the contract in the transaction trace
</ParamField>
<ParamField path="contract_address">
Address of the contract
</ParamField>
<ParamField path="contract_project">
Project name of the contract
</ParamField>
<ParamField path="token_symbol">
Token symbol of the contract, if any
</ParamField>
<ParamField path="contract_name">
Contract name
</ParamField>
<ParamField path="creator_address">
Attribution to the highest-level contract creator address (i.e. which address deployed the factory which deployed contracts), or the tx_from when the contract creator address is non-deterministic.
</ParamField>
<ParamField path="trace_deployer_address">
Attribution to the mapped deployer address at the creation trace, handles for ~most deterministic deployers and smart wallet creations.
</ParamField>
<ParamField path="created_time">
contract creation time
</ParamField>
<ParamField path="is_self_destruct">
Flag if it is a self destruct contract
</ParamField>
<ParamField path="created_tx_hash">
Contract creation transaction hash
</ParamField>
<ParamField path="created_block_number">
Contract creation block number
</ParamField>
<ParamField path="created_tx_from">
Contract creation transaction from address
</ParamField>
<ParamField path="created_tx_to">
Contract creation transaction to address
</ParamField>
<ParamField path="created_tx_method_id">
Method ID of the transaction. This is useful for determining how a contract was deployed (i.e Safe transaction vs traditional deployment)
</ParamField>
<ParamField path="created_tx_index">

</ParamField>
<ParamField path="top_level_contract_address">
Top-Level contract address
</ParamField>
<ParamField path="top_level_time">
Top-Level contract creation transaction block time
</ParamField>
<ParamField path="top_level_tx_hash">
Top-Level contract creation transaction hash
</ParamField>
<ParamField path="top_level_block_number">
Top-Level contract creation transaction block number
</ParamField>
<ParamField path="top_level_tx_from">
Top-Level contract creation transaction from address
</ParamField>
<ParamField path="top_level_tx_to">
Top-Level contract creation transaction to address
</ParamField>
<ParamField path="top_level_tx_method_id">
Method ID of the top-level transaction. This is useful for determining how the top-level contract was deployed (i.e Safe transaction vs traditional deployment)
</ParamField>
<ParamField path="code_bytelength">
Length of the deployed code, measured in bytes. This is used for spam filtering
</ParamField>
<ParamField path="token_standard">
What token standard the contract is. For non-tokens, this field will be null.
</ParamField>
<ParamField path="code">
Runtime bytecode of the contract
</ParamField>
<ParamField path="code_deploy_rank_by_chain">
Was this the 1st, 2rd, 3rd, etc time the same exact bytecode was deployed by chain? (1 &#x3D; 1st). This can be used for spam filtering.
</ParamField>
<ParamField path="is_eoa_deployed">
Was the contract deployed by an EOA (test if the trace creator &#x3D; the transaction sender)
</ParamField>
<ParamField path="is_smart_wallet_deployed">
Was the contract deployed by a smart wallet (i.e. Gnosis Safe, ERC4337 wallet)
</ParamField>
<ParamField path="is_deterministic_deployer_deployed">
Was the contract deployed by a deterministic deployer factory (i.e. create2)
</ParamField>
<ParamField path="is_updated_on_last_run">
Was this contract updated on the last run (used for incremental table building)
</ParamField>
